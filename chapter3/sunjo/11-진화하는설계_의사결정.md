> 경쟁에 뒤처지지 않으려면 계속 변화해야함
소프트웨어 설계도 마찬가지….
>

## 도메인 변경

---

### 핵심에서 일반으로

- 경쟁 우위를 점할 수 없을 경우
- 경쟁 우위로 간주했던 것이 경쟁 업체가 사용할 수 있는 상품이 된 경우

### 일반에서 핵심으로

- 상용 솔루션을 사용하다가 직접 구현한 경우
    - 아마존 → 인프라를 위해서 aws 전환

### 지원에서 일반으로

- 시스템 구현 했다가 사용 솔루션 사용한 경우
    - 시스템 백오피스 → CMS([strapi](https://strapi.io/))

### 지원에서 핵심

- 회사에서 비용을 줄이거나 추가 수익을 창출하는 방식으로 지원 로직을 최적화하는 방법
    - 점점 더 복잡

### 핵심에서 지원

- 복잡성에 비해 수익성이 없는 경우

### 일반에서 지원으로

- 솔루션 사용하다가 시스템 구현한 경우

### 전략적 설계 문제

하위 도메인 유형의 변경은 바운디드 컨텍스트에 직접적인 영향을 미치고 결과적으로 전략적 설계에도 영향을 준다.

- 분리형 노선은 영향을 많이 받는다.
    - 일반, 지원에서 사용하는 패턴인데 핵심으로 변경되면 그 도메인과 연동할 수밖에 없다.
    - 이런 경우 사용자 - 제공자 관계가 된다.

### 전술적 설계 문제

- 주요 지표는 기존의 기술적 설계가 현재 비즈니스 요구를 지원할 수 없는 경우
    - 점점 코드가 커지고 복잡

### 트랜잭션 스크립트에서 액티브 레코드로

- 스크립트에서 데이터 작업이 어려워지면 액티브 레코드 패턴으로 리팩토링 하자

### 액티브 레코드에서 도메인 모델로

- 점점 더 복잡해지고 불일치 및 중복 사례가 많아진다면 도메인 모델 패턴으로 리팩토링 하자
1. 밸류 오브젝트를 식별하는 것으로 시작
2. 자료구조를 분석하고 트랜잭션 경계 찾기
3. 어떤 계층이 필요한지 확인
4. 애그리게이트에 대해 루트 또는 퍼블릭 인터페이스의 엔드포인트를 식별한다.

### 도메인 모델에서 이벤트 소싱 도메인 모델로

- 적절하게 설계된 도메인 모델이 있으면 이벤트 소싱 모델로 전환 가능
- 이력이 없는 상태를 이벤트 기반 모델로 마이그레이션
    - 과거 이벤트 생성
    - 마이그레이션 이벤트를 모델링

## 조직 변화

---

### 파트너십에서 사용자-제공자로

강력한 의사소통이 안될 경우

- 위치상 멀리 있을 경우

### 사용자-제공자에서 분리형 노선으로

의사소통 문제가 생기는 경우

- 지리적 거리나 조직 내부 정치

## 도메인 지식

---

도메인 주도 설계의 핵심은 성공적인 시스템 설계하는데 도메인 지식이 반드시 필요하다.

- 핵심 하위 도메인 로직은 복잡하고 자주 변경된다.
- 처음엔 간단해보이지만 복잡해짐
    - 도메인 로직이 불명확하고 자주 변경되는 경우 바운디드 컨텍스트를 더 넓은 경계로 설계하는 것이 합리적
    - 그 이후 넓은 바운디드 컨텍스트는 좁은 바운디드 컨텍스트로 변환 또는 마이크로서비스로 변환

## 성장

---

- 시스템이 건강하다는 신호
    - 요구사항을 추가로 해결, 확장하고 있다.
    - 반면 커다란 진흙 덩어리로 성장할 수도 있다. ⇒ 설계의 의사결정을 재평가하지 않고 소프트웨어를 확장한 결과
- 복잡성을 식별하고 제거해야한다.

### 하위 도메인

- 유용한 경계를 찾기 위해 노력해야한다.
    - 나중에는 식별하기 어렵기 때문에 잘 식별하자.

### 바운디드 컨텍스트

- 바운디드 컨텍스트가 초점을 잃고 다양한 문제와 관련된 로직이 늘어날 수 있다. ⇒ 우발적 복잡성
    - 다시 살펴보자
    - 단순화 할 수 있나 살펴보자

### 애그리게이트

원칙: 가능한 한 작게 유지, 일관적인 상태를 유지

- 이것을 지키지 못하면 제거할 필요가 있다.
    - 단순해짐
    - 애그리게이트가 속한 바운디드 컨텍스트도 단순해짐


### 결론

비즈니스 전략과 요구사항에 더 잘 맞게 설계하고 변화하고 업데이트하자.

### 연습문제

1. A
2. D
3. C → D
4. F